  - name: "create IF_success_status_{{ option }} job"
    tower_job_template:
      name: "{{ item.name }}"
      description: "{{ item.description }}"
      job_type: run
      inventory: "{{ item.inventory }}"
      project: "{{ item.project }}"
      extra_vars_path: "./files/{{option}}.yml"
      playbook: "{{IF_job['IF_status']['playbook']}}"
      job_tags: "{{option}}_success"
      vault_credential: "{{IF_vault_credentials['name']}}"
      credential: "{{IF_machine_credentials['name']}}"
      state:  "present"
      tower_verify_ssl: no
      concurrent_jobs_enabled: yes
      tower_username: "{{env[env_input]['tower_username']}}"
      tower_password: "{{env[env_input]['tower_password']}}"
      tower_host: "{{env[env_input]['tower_host']}}"
    run_once: true
    with_items: "{{ tower_job_templates }}"

  - name: Create Inventory
    tower_inventory:
      name: "{{IF_inventory.name}}"
      description: "{{IF_inventory.description}}"
      organization: "{{IF_inventory.organization}}"
      state:  "present"
      tower_verify_ssl: no
      tower_username: "{{env[env_input]['tower_username']}}"
      tower_password: "{{env[env_input]['tower_password']}}"
      tower_host: "{{env[env_input]['tower_host']}}"

    with_items: "{{ tower_inventories }}"


  - name: Add Hosts to Inventory
    tower_host:
      name: "{{ item.name }}"
      description: "{{ item.description }}"
      inventory: "{{ tower_inventories[0] }}"
      state: present
      tower_verify_ssl: no
      tower_username: "{{env[env_input]['tower_username']}}"
      tower_password: "{{env[env_input]['tower_password']}}"
      tower_host: "{{env[env_input]['tower_host']}}"
    with_items: "{{ tower_inventories['hosts'] }}"